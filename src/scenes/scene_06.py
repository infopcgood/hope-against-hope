"""Base Scene only used in testing"""
from collections import defaultdict
import pygame

from src.base.assets import assets
from src.characters.npc import NPC
from src.characters.player import Player
from src.events.delay_event import DelayEvent
from src.events.emote_event import PlayerEmoteEvent
from src.scenes.scene import Scene
import src.scenes.start_scene as start_scene
from src.events.scene_change_event import SceneChangeEvent
import src.constants.spritesheet_constants as SpriteSheet_Constants
from src.characters.character import Character
from src.events.dialogue_event import DialogueEvent
from src.events.basic_function_event import BasicFunctionEvent


def interact_with(screen, scene, main_player, npc_idx):
    if scene.interacted_with[npc_idx] == False:
        scene.talked_cnt += 1
        scene.interacted_with[npc_idx] = True

def move_main_player_one_tile(screen, scene, main_player, direction):
    main_player.move_one_tile(direction, screen, scene, main_player)

def force_main_player_facing(screen, scene, main_player, facing):
    main_player.facing = facing

class Scene06(Scene):
    """Base scene only used in testing"""

    def __init__(self, start_tile_x=13, start_tile_y=10):
        super().__init__(32, 18, start_tile_x, start_tile_y, "textures/map/hallway.png",
                         "textures/upper_layer/transparent.png", None,True,
                         True, True, True, [(BasicFunctionEvent, force_main_player_facing, (SpriteSheet_Constants.FACING_RIGHT,)), (DelayEvent, 0.5), (DialogueEvent, '저랑 비슷한 생각을 가지고 계신다고요.'), (DialogueEvent, '네...'), (DialogueEvent, '흠...'), (DialogueEvent, '일단은 저희와 함께 투쟁해 보시겠어요?'), (DialogueEvent, '물론이죠. 그런데 하나 걱정되는 거는...'), (DialogueEvent, '...이 노력이 다 헛된 일이 되어 버릴까 하는 두려움?'), (DialogueEvent, '흠...'), (DialogueEvent, '저도 그런 고민을 많이 했죠...'), (DialogueEvent, '그런데 모든 건 다 믿으면 되더라고요.'), (DialogueEvent, '그런데 모든 건 다 믿으면 되더라고요.')],
                         [NPC(17, 10, SpriteSheet_Constants.FACING_LEFT, 'textures/spritesheets/Leader.png')])
        self.movable_tiles = [
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0]]
        self.talked_cnt = 0
        self.interacted_with = [False, False, False, False, False, False, False, False, False, False, False,]

    def load(self, screen, main_player):
        main_player.visible = True
        super().load(screen, main_player)

    def add_event_system(self, screen, main_player):
        pass

    def npc01_move(self, screen, scene, main_player):
        """npc01 move"""
        self.npcs[0].move_one_tile(SpriteSheet_Constants.FACING_LEFT, screen, scene, main_player)

    def shake_screen(self, screen, scene, main_player):
        main_player.shake_screen = True